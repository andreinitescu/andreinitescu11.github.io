<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
	<title>Advanced mint monitoring - Paris.js #39- Jonathan Petitcolas</title>

	<link href="../csss/slideshow.css" rel="stylesheet" />
	<link href="../csss/theme.css" rel="stylesheet" />
	<link href="style.css" rel="stylesheet" />
	<script src="../csss/prefixfree.min.js"></script>

    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
</head>
<body>
<section>
	<header class="slide background" style="background-image: url(mint.jpg);">
        <style scoped="scoped">
            h1 {
                position: relative;
                margin-top: 15%;
                margin-bottom: 0.5em;
            }
        </style>
		<h1>Advanced mint monitoring</h1>
        <p>
            Jonathan Petitcolas (<a href="https://www.twitter.com/sethpolma">@Sethpolma</a>) - Paris.js - September 2014<br />
            <a href="http://www.jonathan-petitcolas.com">www.jonathan-petitcolas.com</a>
        </p>
        <p class="attribution">
            Picture:
            <a href="https://www.flickr.com/photos/siriwan/482649686">
                Pepper-mint, by Pawel
            </a>
        </p>
	</header>

	<section class="slide background" style="background-image: url(jonathan-petitcolas-8bit-tie.jpg); background-size: cover; border: 0; padding: 0 5% 3%;">
		<div style="position: absolute; right: 50px; width: 50%; margin-top: 50px;">
            <h2>Jonathan Petitcolas</h2>
			<p class="delayed">Developer at <a href="http://www.marmelab.com">marmelab</a><br/>Symfony2, Node.js, Go, D3.js</p>
			<p class="delayed">
                Open-source contributor: <a href="http://marmelab.com/phpunit-d3-report/">PHPUnit D3 report</a>
            </p>
            <p class="delayed">Organizer of <a href="https://twitter.com/AperoWebNancy">Apéros Web Nancy</a></p>
            <p class="delayed">
                Twitter : <a href="https://twitter.com/Sethpolma">@Sethpolma</a><br />
                GitHub : <a href="https://github.com/jpetitcolas">jpetitcolas</a>
            </p>
		</div>
	</section>

	<section class="slide">
        <style scoped="scoped">
           li {
               width: 30%;
               display: inline-flex;
               text-align: center;
           }

           li p {
               width: 100%;
               font-size: 150%;
           }

           li img {
               max-height: 500px;
               max-width: 100%;
           }

           li::before {
               content: "";
           }
        </style>
		<h2>Monitoring what?</h2>
        <ul>
            <li class="delayed">
                <p>
                    <img src="sun.png" alt="Lumière"/><br />
                    Light
                </p>
            </li>
            <li class="delayed">
                <p>
                    <img src="thermometer.png" alt="Température"/><br />
                    Temperature
                </p>
            </li>
            <li class="delayed">
                <p>
                    <img src="drop.png" alt="Humidité"/><br />
                    Humidity
                </p>
            </li>
        </ul>
	</section>
</section>

<section>
    <header class="slide background" style="background-image: url(arduino.jpg);">
        <h1>Arduino</h1>
        <p class="attribution">
            Picture:
            <a href="https://www.flickr.com/photos/gabriellalevine/9583831483/in/photolist-fATDcR-diKRxP-69HfGN-8VRoDe-8yo7VR-5sEZYu-4MYtLJ-8Ng8a1-dBKAW4-eBPF3a-6agNNc-5SAaCK-8X8hLe-6rg39i-5B1Lfo-3EAgU2-8QLAAE-adQqaY-iYHviw-5vhJcc-5Qs3ix-sjRGt-5XwBFB-4tR2pJ-aCTkn4-by4KN-8X8hPe-4EaL9o-5S7Yjr-4ckNrU-xedra-dPn31e-5NHSys-8yuFfH-91daJe-4gRaWH-8d1LM8-6u32Sf-5oZuGc-9gLFGs-8iR6h8-5Drouk-frdTPE-8Ng8Gf-8yo7U4-4wcyP3-dF1cXF-fa7aQD-fa7aLT-3Lf1Fr">
                Arduino, Gabriella Levine
            </a>
        </p>
    </header>

    <section class="slide" style="text-align: center; background: #fff;">
        <style scoped="scoped">
            img {
                height: 100%;
            }
        </style>
        <img src="arduino-details.jpg" alt="Arduino" />
    </section>

	<section class="slide" style="text-align: center;">
        <style scoped="scoped">
            img {
                height: 100%;
            }
        </style>
        <img src="breadboard.jpg" alt="Breadboard" />
	</section>

	<section class="slide" style="text-align: center;">
        <style scoped="scoped">
            img {
                height: 100%;
            }
        </style>
        <img src="breadboard-with-connections.jpg" alt="Breadboard" />
	</section>
</section>

<section>
    <header class="slide" style="background-image: url(johnny-five.png); background-color: #fff; background-repeat: repeat-x">
        <h1>JohnnyFive</h1>
        <p class="attribution">
            Picture:
            <a href="https://www.flickr.com/photos/kielbryant/2252304874/in/photolist-4DUoNX-9Yhn2G-dgbSsj-idyE1-2MEGxJ-92ZsJC-4XpQj4-6KoHsa-6WeWya-62Gvzr-o9Gf3y-4r2DLE-5Wo2Lb-2mLbJZ-6jchhu-5tC1u4-cYcKvW-4WY6Fc-ipkXW-n2r2Pn-tvkqz-7PECfW-4ZeW8b-6ooUbq-idEQg-aXUUHa-aXUUNV-4Lw98o-aXUUKT-7Zxnn5-cNFV2u-XHgFv-6AEDHm-3icf7s-6AAstD-6AAodV-6HqDqo-cWFmbo-cWFkPq-cWFkJj-cWFkYA-cWFkDY-5YCJqk-fnxZy9-cjqRM-5F8oWJ-5YGX2N-5YGXG1-5YGXku-5YGXKW">
                Wall-Who?, Kiel Bryant
            </a>
        </p>
    </header>

    <section class="slide">
        <style scoped="scoped">
            img {
                display: inline-block;
                max-width: 50%;
                margin-right: 40px;
                float: left;
            }
        </style>
        <h2>Temperature sensor TMP36</h2>
        <img src="tmp36.jpg" alt="TMP36 temperature sensor" title="TMP36 temperature sensor" />
        <ul>
            <li class="delayed">Datasheet : <a href="http://www.gotronic.fr/pj-883.pdf">TMP3x</a></li>
            <li class="delayed">Polarized component</li>
            <li class="delayed">
                Output voltage only depend from temperature:
                <p class="equation delayed">
                    \(T = 100 * V_{out} - 50\)
                </p>
            </li>
        </ul>
        <div style="clear: both;"></div>
    </section>

    <section class="slide">
        <h2>Installing Johnny Five</h2>
        <pre><code lang="javascript">// package.json
{
    "dependencies": {
        "johnny-five": "latest"
    }
}</code></pre>

        <pre><code lang="shell">npm install</code></pre>
    </section>

    <section class="slide">
        <h2>Displaying temperature</h2>
        <pre><code lang="javascript">var five = require('johnny-five');

var board = new five.Board();
var temperatureSensor;

board.on('ready', function() {
    temperatureSensor = new five.Sensor({ pin: 'A0', freq: 1000 });
    temperatureSensor.on('data', function() {
        console.log(getTemperature() + "°C");
    });
});

function getTemperature() {
    var out = temperatureSensor.value * (5 / 1023);
    return Math.round(out * 100 – 50);
}</code></pre>
    </section>

    <section class="slide">
        <h2>Smoothing output</h2>
        <style scoped="scoped">
            img {
                display: inline-block;
                max-width: 50%;
                margin-right: 40px;
                float: left;
            }
        </style>
        <img src="tmp36-circuit.jpg" alt="Capteur de température TMP36"/>
        <ul>
            <li class="delayed">Very low intensity</li>
            <li class="delayed">Very sensitive to electro-magnetic noise</li>
            <li class="delayed">Too long wires => unstable output</li>
            <li class="delayed">Smoothing output with capacitors</li>
        </ul>
    </section>

    <section class="slide">
        <style scoped="scoped">
            img {
                float: left;
                max-width: 20%;
                margin-right: 5%;
                border-radius: 50px;
                margin-bottom: 50px;
            }

            td {
                padding: 3px 20px;
            }

            thead td {
                background: #96815F;
            }

            .odd td {
                background: #CFBD9F;
            }

            .even td {
                background: #BBA887;
            }
        </style>
        <h2>Photoresistor SEN-09088</h2>
        <img src="sen-09088.jpg" alt="Photo-résistance SEN-09088"/>
        <ul>
            <li class="delayed">Datasheet : <a href="http://dlnmh9ip6v2uc.cloudfront.net/datasheets/Sensors/LightImaging/SEN-09088.pdf">SEN-09088</a></li>
            <li class="delayed">Non linear resistance</li>
            <li class="delayed">Calibration required</li>
        </ul>
        <table class="delayed" style="width: 69%; margin-top: 1em;">
            <thead>
                <tr>
                    <td></td>
                    <td>Light</td>
                    <td>Resistance</td>
                </tr>
            </thead>
            <tbody>
                <tr class="odd">
                    <td>Darkness</td>
                    <td>1 Lux</td>
                    <td>1.4 M&ohm;</td>
                </tr>
                <tr class="even">
                    <td>Rainy day</td>
                    <td>1 100 Lux</td>
                    <td>850 &ohm;</td>
                </tr>
                <tr class="odd">
                    <td>Torch light</td>
                    <td>8 000 Lux</td>
                    <td>200 &ohm;</td>
                </tr>
                <tr class="even">
                    <td>Sunny day</td>
                    <td>30 000 Lux</td>
                    <td>120 &ohm;</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section class="slide">
        <style scoped="scoped">
            img {
                float: left;
                margin-right: 80px;
                padding: 30px;
                background: #fff;
            }
        </style>
        <h2>Voltage divider bridge</h2>
        <img src="voltage-divider.jpg" alt="Voltage divider bridge" />
        <p class="delayed">Ohm's law:<br/>$U = R * I$</p>
        <p class="delayed">Mesh method:<br/>$U = U_{1} + U_{2}$</p>
        <p class="delayed">Voltage divider:<br/>$U_{2} = U * \frac{R_{2}}{R_{2} + R_{1}}$</p>
        <p class="delayed" style="font-size: 2em; margin-top: 2em;">$R_{2} = \frac{U_{2} * R_{1}}{(U - U_{2})}$</p>
    </section>

    <section class="slide">
        <h2>Displaying light</h2>
        <pre><code lang="javascript">var VOLTAGE = 5;
var LIGHT_DIVIDER_RESISTANCE = 10;

board.on('ready', function() {
    lightSensor = new five.Sensor('A1');
    lightSensor.scale([0, 1023]);

    lightSensor.on('data', function() {
        console.log(getLightResistance() + '%');
    });
});

function getLightResistance() {
    var r  = lightSensor.value * LIGHT_DIVIDER_RESISTANCE;
    r /= (VOLTAGE – lightSensor.value);

    return r;
}</code></pre>
    </section>

    <section class="slide">
        <style scoped="scoped">
            img {
                float: left;
                margin-right: 80px;
                padding: 30px;
                background: #fff;
                border-radius: 30px;
            }
        </style>
        <h2>Humidity sensor à la MacGyver</h2>
        <img src="humidity.jpg" alt="Humidity sensor"/>
        <ul>
            <li class="delayed">Voltage proportional to humidity</li>
            <li class="delayed">Calibration required: dry and wet soil</li>
            <li class="delayed">Zinc-coated or stainless steel wire</li>
            <li class="delayed">Compost = chemical reactor</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Displaying humidity rate</h2>
        <pre><code lang="javascript">var HUMIDITY_DRY_RESISTANCE = 150;
var HUMIDITY_WET_RESISTANCE = 10;
var HUMIDITY_DIVIDER_RESISTANCE = 10;

board.on('ready', function() {
    humiditySensor = new five.Sensor({ pin: 'A2', frequency: 2000 });
    humiditySensor.scale([0, VOLTAGE]);

    humiditySensor.on('data', function() {
        console.log(getHumidity() + '%');
    });
});

function getHumidity() {
    var resistance = humiditySensor.value * HUMIDITY_DIVIDER_RESISTANCE / (VOLTAGE - humiditySensor.value);
    var humidityRate = 100 * (HUMIDITY_DRY_RESISTANCE - resistance) / (HUMIDITY_DRY_RESISTANCE - HUMIDITY_WET_RESISTANCE);

    return Math.round(humidityRate);
}
</code></pre></section>
</section>

<section>
	<header class="slide" style="background: url(data-storm.jpg)">
		<h1>Websockets</h1>
        <p class="attribution">
            Picture:
            <a href="https://www.flickr.com/photos/dherholz/450303689/in/photolist-FMVAH-2dkp-ekYLQy-6EMnyQ-h4RV3y-fY9CgE-amkoeY-5hrCbv-dxi7Hk-ddn815-az29P5-4nWCrn-gbA7WS-iQVE1q-dXPWkB-c2nrdA-fkKdFR-8nRZnP-9U1s1d-9u6D1T-dRuMzt-8LCNW2-6EHcWT-4o6CuZ-7Xk9LM-6yx8zu-bf2wDV-egsmCb-9qqm6E-bikuZR-kwvpGe-i3N6NQ-i3NEbc-dL8cys-bB1z8A-iuSuaX-atW8Xa-3rdsAL-cS7n4o-98rFiH-55dS5R-9qqkKq-duzsNr-8xGZxL-2Wa9no-dTA1nq-3qhvia-hypmYn-7fr163-khg">
                Data storm, Dave HerholzRosemary
            </a>
        </p>
	</header>

    <section class="slide">
        <h2>Installing socket.io</h2>
        <pre class="delayed"><code lang="javascript">// package.json
{
    "dependencies": {
        // ...
        "socket.io": "latest"
    }
}</code></pre>
        <pre class="delayed"><code>npm install</code></pre>
    </section>

    <section class="slide">
        <h2>Socket.io: server side</h2>
        <pre><code lang="javascript">var io = require('socket.io').listen(8080);

board.on('ready', function() {
    io.sockets.on('connection', function(socket) {
        console.log('New connection: ' + socket.id);

        tempSensor.on('data', function() {
            socket.emit('temp', getTemperature());
        });
    });
});</code></pre>
    </section>

    <section class="slide">
        <h2>Socket.io: client side</h2>
        <pre class="delayed"><code lang="xhtml">&lt;script src="//:8080/socket.io/socket.io.js"&gt;
&lt;/script&gt;</code></pre>
        <pre class="delayed"><code lang="javascript">var socket = io.connect("//:8080");

socket.on("temp", function (value) {
    $(".temperature .value").text(value + "°C");
});</code></pre>
    </section>

</section>

<section>
    <header class="slide" style="background-image: url(question.jpg); background-position: center -240px;">
        <h1>Any questions?</h1>
        <p class="attribution">
            Picture:
            <a href="https://www.flickr.com/photos/jarbo/9379813470">
                Question Mark Block, Jared Cherup
            </a>
        </p>
    </header>
</section>

<footer class="slide" title="The End">
	<h2>Thanks!</h2>
    <p style="text-align: center; font-size: 2em; margin-top: 2em;">
        <a href="http://www.twitter.com/Sethpolma">@Sethpolma</a><br />
        <a href="http://www.jonathan-petitcolas.com">www.jonathan-petitcolas.com</a><br />
        <span class="delayed">(and of course <a href="http://www.marmelab.com">www.marmelab.com</a>)</span>
    </p>
</footer>

<script src="../csss/slideshow.js"></script>
<script src="../csss/plugins/code-highlight.js"></script>
<script>var slideshow = new SlideShow();</script>
</body>
</html>
